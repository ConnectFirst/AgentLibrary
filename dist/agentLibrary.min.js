/*! cf-agent-library - v0.0.0 - 2016-08-02 - Connect First */
!function(a){function b(a){for(var b=o.getInstance().outboundSettings.availableOutdialGroups,c=0;c<b.length;c++){var d=b[c];d.dialGroupId===a.ui_response.outdial_group_id["#text"]&&(o.getInstance().agentPermissions.allowLeadSearch=d.allowLeadSearch,o.getInstance().agentPermissions.allowPreviewLeadFilters=d.allowPreviewLeadFilters,o.getInstance().outboundSettings.outdialGroup=JSON.parse(JSON.stringify(d)),o.getInstance().agentPermissions.requireFetchedLeadsCalled=d.requireFetchedLeadsCalled)}}function c(){for(var a=o.getInstance().inboundSettings.availableQueues,b=o.getInstance().configRequest.queueIds,c=[],d=0;d<a.length;d++){var e=a[d];b.indexOf(e.gateId)>-1&&c.push(e)}o.getInstance().inboundSettings.queues=JSON.parse(JSON.stringify(c))}function d(){for(var a=o.getInstance().chatSettings.availableChatQueues,b=o.getInstance().configRequest.chatIds,c=[],d=0;d<a.length;d++){var e=a[d];b.indexOf(e.chatQueueId)>-1&&c.push(e)}o.getInstance().chatSettings.chatQueues=JSON.parse(JSON.stringify(c))}function e(){for(var a=o.getInstance().inboundSettings.availableSkillProfiles,b=0;b<a.length;b++){var c=a[b];c.skillProfileId===o.getInstance().configRequest.skillProfileId&&(o.getInstance().inboundSettings.skillProfile=JSON.parse(JSON.stringify(c)))}}function f(a){"use strict";var b=a.AgentLibrary=function(a){return a=a||{},this.callbacks={},"undefined"!=typeof a.callbacks&&(this.callbacks=a.callbacks),"undefined"!=typeof a.socketDest&&(o.getInstance().socketDest=a.socketDest,this.openSocket()),this};b.prototype.setCallbacks=function(a){for(var b in a)this.callbacks[b]=a[b]},b.prototype.setCallback=function(a,b){this.callbacks[a]=b},b.prototype.getCallbacks=function(){return this.callbacks},b.prototype.getCallback=function(a){return this.callbacks[a]},b.prototype.getLoginRequest=function(){return o.getInstance().loginRequest},b.prototype.getConfigRequest=function(){return o.getInstance().configRequest},b.prototype.getLogoutRequest=function(){return o.getInstance().logoutRequest},b.prototype.getAgentStateRequest=function(){return o.getInstance().agentStateRequest},b.prototype.getLoginPacket=function(){return o.getInstance().loginPacket},b.prototype.getConfigPacket=function(){return o.getInstance().configPacket},b.prototype.getAgentStatePacket=function(){return o.getInstance().agentStatePacket},b.prototype.getCurrentCallPacket=function(){return o.getInstance().currentCallPacket},b.prototype.getApplicationSettings=function(){return o.getInstance().applicationSettings},b.prototype.getChatSettings=function(){return o.getInstance().chatSettings},b.prototype.getInboundSettings=function(){return o.getInstance().inboundSettings},b.prototype.getOutboundSettings=function(){return o.getInstance().outboundSettings},b.prototype.getAgentSettings=function(){return o.getInstance().agentSettings},b.prototype.getAgentPermissions=function(){return o.getInstance().agentPermissions}}function g(a){"use strict";var b=a.AgentLibrary;b.prototype.openSocket=function(b){var c=this;p.setCallback(c,q.OPEN_SOCKET,b),"WebSocket"in a?(console.log("AgentLibrary: attempting to open socket connection..."),c.socket=new WebSocket(o.getInstance().socketDest),c.socket.onopen=function(){o.getInstance().socketConnected=!0,p.fireCallback(c,q.OPEN_SOCKET,"")},c.socket.onmessage=function(a){var b=JSON.parse(a.data);b.ui_response?p.processResponse(c,b):b.ui_notification&&p.processNotification(c,b)},c.socket.onclose=function(){p.fireCallback(c,q.CLOSE_SOCKET,""),o.getInstance().socketConnected=!1}):console.warn("AgentLibrary: WebSocket NOT supported by your Browser.")},b.prototype.closeSocket=function(){this.socket.close()}}function h(a){"use strict";var b=a.AgentLibrary;b.prototype.loginAgent=function(a,b,c){o.getInstance().loginRequest=new k(a,b);var d=o.getInstance().loginRequest.formatJSON();p.setCallback(this,q.LOGIN,c),p.sendMessage(this,d)},b.prototype.configureAgent=function(a,b,c,d,e,f){o.getInstance().configRequest=new j(a,b,c,d,e);var g=o.getInstance().configRequest.formatJSON();p.setCallback(this,q.CONFIG,f),p.sendMessage(this,g)},b.prototype.logoutAgent=function(a,b){if(o.getInstance().logoutRequest=new l(a),p.setCallback(this,q.LOGOUT,b),o.getInstance().logoutRequest.isSupervisor){var c=o.getInstance().logoutRequest.formatJSON();p.sendMessage(this,c)}else p.fireCallback(this,q.LOGOUT,""),this.closeSocket()},b.prototype.setAgentState=function(a,b,c){o.getInstance().agentStateRequest=new i(a,b);var d=o.getInstance().agentStateRequest.formatJSON();p.setCallback(this,q.AGENT_STATE,c),p.sendMessage(this,d)},b.prototype.offhookInit=function(a){o.getInstance().offhookInitRequest=new m;var b=o.getInstance().offhookInitRequest.formatJSON();p.setCallback(this,q.OFFHOOK_INIT,a),p.sendMessage(this,b)},b.prototype.offhookTerm=function(a){o.getInstance().offhookTermRequest=new n;var b=o.getInstance().offhookTermRequest.formatJSON();p.setCallback(this,q.OFFHOOK_TERM,a),p.sendMessage(this,b)}}var i=function(a,b){"ON-BREAK"==a.toUpperCase()&&1==o.getInstance().onCall?(this.agentState="BREAK-AFTER-CALL",this.agentAuxState=""):(this.agentState=a.toUpperCase()||"",this.agentAuxState=b||"")};i.prototype.formatJSON=function(){var a={ui_request:{"@destination":"IQ","@type":r.AGENT_STATE,"@message_id":p.getMessageId(),response_to:"",agent_id:{"#text":o.getInstance().agentSettings.agentId},state:{"#text":this.agentState},agent_aux_state:{"#text":this.agentAuxState}}};return JSON.stringify(a)},i.prototype.processResponse=function(a){var b=a.ui_response.status["#text"],c=a.ui_response.prev_state["#text"],d=a.ui_response.current_state["#text"],e=a.ui_response.prev_aux_state["#text"]||"",f=a.ui_response.agent_aux_state["#text"]||"";if("OK"==b){var g=c,h=d;e.length>0&&(g=e),f.length>0&&(h=f),console.log("AgentLibrary: Agent state changed from ["+g+"] to ["+h+"]"),o.getInstance().agentSettings.currentState=d,o.getInstance().agentSettings.currentStateLabel=f,o.getInstance().agentStatePacket=a}else console.warn("AgentLibrary: Unable to change agent state "+a.detail["#text"])};var j=function(a,b,c,d,e){this.queueIds=a||[],this.chatIds=b||[],this.skillPofileId=c||"",this.outdialGroupId=d||"",this.dialDest=e||"",this.updateFromAdminUI=!1,this.loginType="NO-SELECTION",this.updateLogin=!1,this.queueIds=p.checkExistingIds(o.getInstance().inboundSettings.availableQueues,this.queueIds,"gateId"),this.chatIds=p.checkExistingIds(o.getInstance().chatSettings.availableChatQueues,this.chatIds,"chatQueueId"),this.skillPofileId=p.checkExistingIds(o.getInstance().inboundSettings.availableSkillProfiles,[this.skillPofileId],"profileId")[0]||"",this.outdialGroupId=p.checkExistingIds(o.getInstance().outboundSettings.availableOutdialGroups,[this.outdialGroupId],"dialGroupId")[0]||"",this.queueIds.length>0&&""!==this.outdialGroupId?this.loginType="BLENDED":this.queueIds.length>0?this.loginType="INBOUND":""!==this.outdialGroupId?this.loginType="OUTBOUND":this.loginType="NO-SELECTION",o.getInstance().isLoggedIn&&(this.updateLogin=!0),p.validateDest(this.dialDest)||console.error("AgentLibrary: dialDest must be a valid sip or 10-digit DID")};j.prototype.formatJSON=function(){for(var a={ui_request:{"@destination":"IQ","@type":r.LOGIN,"@message_id":p.getMessageId(),response_to:"",agent_id:{"#text":o.getInstance().agentSettings.agentId},agent_pwd:{"#text":o.getInstance().loginRequest.password},dial_dest:{"#text":this.dialDest},login_type:{"#text":this.loginType},update_login:{"#text":this.updateLogin.toString()},outdial_group_id:{"#text":this.outdialGroupId},skill_profile_id:{"#text":this.skillPofileId},update_from_adminui:{"#text":this.updateFromAdminUI.toString()}}},b=[],c=0;c<this.queueIds.length;c++)""!==this.queueIds[c]&&b.push({"#text":this.queueIds[c]});b.length>0?a.ui_request.gates={gate_id:b}:a.ui_request.gates={};for(var d=[],c=0;c<this.chatIds.length;c++)""!==this.chatIds[c]&&d.push({"#text":this.chatIds[c]});return d.length>0?a.ui_request.chat_queues={chat_queue_id:d}:a.ui_request.chat_queues={},JSON.stringify(a)},j.prototype.processResponse=function(a){var f=a.ui_response.status["#text"];"SUCCESS"===f?o.getInstance().isLoggedIn?o.getInstance().agentSettings.updateLoginMode?(o.getInstance().agentSettings.updateLoginMode=!1,o.getInstance().agentPermissions.allowLeadSearch=!1,o.getInstance().agentPermissions.requireFetchedLeadsCalled=!1,o.getInstance().agentPermissions.allowPreviewLeadFilters=!1,b(a),c(),d(),e()):console.log("AgentLibrary: Processed a Layer 2 Reconnect Successfully"):(o.getInstance().configPacket=a,o.getInstance().connectionSettings.hashCode=a.ui_response.hash_code["#text"],o.getInstance().applicationSettings.message=a.ui_response.message["#text"],o.getInstance().agentSettings.isLoggedIn=!0,o.getInstance().agentSettings.loginDTS=new Date,o.getInstance().connectionSettings.reconnect=!0,o.getInstance().agentPermissions.allowLeadSearch=!1,o.getInstance().agentSettings.dialDest=o.getInstance().configRequest.dialDest,o.getInstance().agentSettings.loginType=a.ui_response.login_type["#text"],b(a),c(),d(),e()):console.warn("AgentLibrary: Layer 2 login failed!")};var k=function(a,b){this.username=a,this.password=b};k.prototype.formatJSON=function(){var a={ui_request:{"@destination":"IS","@type":r.LOGIN,"@message_id":p.getMessageId(),response_to:"",username:{"#text":this.username},password:{"#text":this.password}}};return JSON.stringify(a)},k.prototype.processResponse=function(a){var b=a.ui_response.status["#text"];if("OK"===b){if(!o.getInstance().isLoggedInIS){o.getInstance().loginPacket=a,o.getInstance().applicationSettings.isLoggedInIS=!0,o.getInstance().agentSettings.loginDTS=new Date,o.getInstance().chatSettings.alias=a.ui_response.first_name["#text"]+" "+a.ui_response.last_name["#text"],o.getInstance().agentSettings.maxBreakTime=a.ui_response.max_break_time["#text"],o.getInstance().agentSettings.maxLunchTime=a.ui_response.max_lunch_time["#text"],o.getInstance().agentSettings.firstName=a.ui_response.first_name["#text"],o.getInstance().agentSettings.lastName=a.ui_response.last_name["#text"],o.getInstance().agentSettings.email=a.ui_response.email["#text"],o.getInstance().agentSettings.agentId=a.ui_response.agent_id["#text"],o.getInstance().agentSettings.externalAgentId=a.ui_response.external_agent_id["#text"],o.getInstance().agentSettings.agentType=a.ui_response.agent_type["#text"],o.getInstance().agentSettings.realAgentType=a.ui_response.real_agent_type["#text"],o.getInstance().agentSettings.defaultLoginDest=a.ui_response.default_login_dest["#text"],o.getInstance().agentSettings.altDefaultLoginDest=a.ui_response.alt_default_login_dest["#text"],o.getInstance().agentSettings.disableSupervisorMonitoring=a.ui_response.disable_supervisor_monitoring["#text"],o.getInstance().agentSettings.initLoginState=a.ui_response.init_login_state["#text"],o.getInstance().agentSettings.initLoginStateLabel=a.ui_response.init_login_state_label["#text"],o.getInstance().agentSettings.outboundManualDefaultRingtime=a.ui_response.outbound_manual_default_ringtime["#text"];var c="undefined"==typeof a.ui_response.allow_call_control?!1:a.ui_response.allow_call_control["#text"],d="undefined"==typeof a.ui_response.allow_chat?!1:a.ui_response.allow_chat["#text"],e="undefined"==typeof a.ui_response.show_lead_history?!1:a.ui_response.show_lead_history["#text"],f="undefined"==typeof a.ui_response.allow_manual_outbound_gates?!1:a.ui_response.allow_manual_outbound_gates["#text"],g="undefined"==typeof a.ui_response.tcpa_safe_mode?!1:a.ui_response.tcpa_safe_mode["#text"],h="undefined"==typeof a.ui_response.insert_campaigns?!1:a.ui_response.insert_campaigns.campaign,i="undefined"==typeof a.ui_response.outbound_prepay?!1:a.ui_response.outbound_prepay["#text"];"0"==c&&(o.getInstance().agentPermissions.allowCallControl=!1),"1"==d&&(o.getInstance().agentPermissions.allowChat=!0),"0"==e&&(o.getInstance().agentPermissions.showLeadHistory=!1),"1"==f&&(o.getInstance().agentPermissions.allowManualOutboundGates=!0),"1"==g&&(o.getInstance().applicationSettings.isTcpaSafeMode=!0),h&&h.length>0&&(o.getInstance().agentPermissions.allowLeadInserts=!0),"1"==i&&(o.getInstance().agentSettings.isOutboundPrepay=!0),"0"==a.ui_response.allow_off_hook["#text"]&&(o.getInstance().agentPermissions.allowOffHook=!1),"0"==a.ui_response.allow_manual_calls["#text"]&&(o.getInstance().agentPermissions.allowManualCalls=!1),"0"==a.ui_response.allow_manual_pass["#text"]&&(o.getInstance().agentPermissions.allowManualPass=!1),"1"==a.ui_response.allow_manual_intl_calls["#text"]&&(o.getInstance().agentPermissions.allowManualIntlCalls=!0),"0"==a.ui_response.allow_login_updates["#text"]&&(o.getInstance().agentPermissions.allowLoginUpdates=!1),"0"==a.ui_response.allow_inbound["#text"]&&(o.getInstance().agentPermissions.allowInbound=!1),"0"==a.ui_response.allow_outbound["#text"]&&(o.getInstance().agentPermissions.allowOutbound=!1),"0"==a.ui_response.allow_blended["#text"]&&(o.getInstance().agentPermissions.allowBlended=!1),"0"==a.ui_response.allow_login_control["#text"]&&(o.getInstance().agentPermissions.allowLoginControl=!1),"1"==a.ui_response.allow_cross_gate_requeue["#text"]&&(o.getInstance().agentPermissions.allowCrossQueueRequeue=!0),processCampaigns(a),o.getInstance().chatSettings.availableChatQueues=p.processResponseCollection(a.ui_response,"login_chat_queues","chat_queue"),o.getInstance().inboundSettings.availableQueues=p.processResponseCollection(a.ui_response,"login_gates","gate"),o.getInstance().inboundSettings.availableSkillProfiles=p.processResponseCollection(a.ui_response,"skill_profiles","profile"),o.getInstance().inboundSettings.availableRequeueQueues=p.processResponseCollection(a.ui_response,"requeue_gates","gate_group"),o.getInstance().chatSettings.availableChatRooms=p.processResponseCollection(a.ui_response,"chat_rooms","room"),o.getInstance().surveySettings.availableSurveys=p.processResponseCollection(a.ui_response,"surveys","survey"),o.getInstance().agentSettings.callerIds=p.processResponseCollection(a.ui_response,"caller_ids","caller_id"),o.getInstance().agentSettings.availableAgentStates=p.processResponseCollection(a.ui_response,"agent_states","agent_state"),o.getInstance().applicationSettings.availableCountries=p.processResponseCollection(a.ui_response,"account_countries","country"),o.getInstance().outboundSettings.insertCampaigns=p.processResponseCollection(a.ui_response,"insert_campaigns","campaign");var j=p.processResponseCollection(a.ui_response,"outdial_groups","group");j.allowLeadSearch="YES"==j.allowLeadSearch,j.allowPreviewLeadFilters="1"==j.allowPreviewLeadFilters,j.allowProgressiveEnabled="1"==j.allowProgressiveEnabled,o.getInstance().outboundSettings.availableOutdialGroups=j}}else"RESTRICTED"===b?console.log("AgentLibrary: Invalid IP Address"):console.log("AgentLibrary: Invalid Username or password")},processCampaigns=function(a){var b=[],c={},d=[],e=[],f=[],g="",h=0,i=!1;if("undefined"!=typeof a.ui_response.campaigns.campaign&&(d=a.ui_response.campaigns.campaign),Array.isArray(d))for(var j=0;j<d.length;j++){h=d[j]["@campaign_id"],i="1"==d[j]["@allow_lead_updates"],e=d[j].custom_labels,f=[],g="",o.getInstance().agentPermissions.allowLeadUpdatesByCampaign[h]=i;for(var k in e){g=k.replace(/@/,"");var l={};l[g]=e[k],f.push(l)}c={allowLeadUpdates:i,campaignId:h,surveyId:d[j]["@survey_id"],surveyName:d[j]["@survey_name"],customLabels:f},b.push(c)}else{h=d[j]["@campaign_id"],i="1"==d[j]["@allow_lead_updates"],e=d.custom_labels,f=[],g="",o.getInstance().agentPermissions.allowLeadUpdatesByCampaign[h]=i;for(var m in e){g=m.replace(/@/,"");var l={};l[g]=e[m],f.push(l)}c={allowLeadUpdates:d["@allow_lead_updates"],campaignId:d["@campaign_id"],surveyId:d["@survey_id"],surveyName:d["@survey_name"],customLabels:f},b.push(c)}o.getInstance().outboundSettings.availableCampaigns=b};var l=function(a,b,c){this.agentId=a,this.message=b,this.isSupervisor=c};l.prototype.formatJSON=function(){var a={ui_request:{"@destination":"IQ","@type":r.LOGOUT,"@message_id":p.getMessageId(),response_to:"",agent_id:{"#text":this.agentId},message:{"#text":this.message}}};return JSON.stringify(a)};var m=function(a){};m.prototype.formatJSON=function(){var a={ui_request:{"@destination":"IQ","@type":r.OFFHOOK_INIT,"@message_id":p.getMessageId(),response_to:"",agent_id:{"#text":o.getInstance().agentSettings.agentId},dial_dest:{"#text":o.getInstance().agentSettings.dialDest}}};return JSON.stringify(a)},m.prototype.processResponse=function(a){var b=a.ui_response.status["#text"];"OK"===b?(o.getInstance().offhookInitPacket=a,o.getInstance().agentSettings.isOffhook=!0):(o.getInstance().logger.error(this,"Unable to process offhook request, "+packet.detail[0]),console.log("AgentLibrary: Unable to process offhook request ",a.ui_response.detail["#text"]))};var n=function(a){};n.prototype.formatJSON=function(){var a={ui_request:{"@destination":"IQ","@type":r.OFFHOOK_TERM,"@message_id":p.getMessageId(),response_to:"",agent_id:{"#text":o.getInstance().agentSettings.agentId}}};return JSON.stringify(a)},n.prototype.processResponse=function(a){var b="1"===a.ui_notification.monitoring["#text"];o.getInstance().agentSettings.wasMonitoring=b,o.getInstance().offhookTermPacket=a,o.getInstance().agentSettings.isOffhook=!1};var o=function(){function a(){return{agentStateRequest:null,configRequest:null,logoutRequest:null,loginRequest:null,offhookInitRequest:null,offhookTermRequest:null,agentStatePacket:null,configPacket:null,currentCallPacket:null,loginPacket:null,offhookInitPacket:null,offhookTermPacket:null,applicationSettings:{availableCountries:[],isLoggedInIS:!1,socketConnected:!1,message:"",isTcpaSafeMode:!1},agentSettings:{agentId:0,agentType:"AGENT",altDefaultLoginDest:"",availableAgentStates:[],callerIds:[],currentState:"OFFLINE",currentStateLabel:"",defaultLoginDest:"",dialDest:"",email:"",externalAgentId:"",firstName:"",isLoggedIn:!1,isOffhook:!1,initLoginState:"AVAILABLE",initLoginStateLabel:"Available",isOutboundPrepay:!1,lastName:"",loginDTS:null,loginType:"NO-SELECTION",maxBreakTime:-1,maxLunchTime:-1,onCall:!1,outboundManualDefaultRingtime:"30",realAgentType:"AGENT",updateLoginMode:!1,wasMonitoring:!1},agentPermissions:{allowBlended:!0,allowCallControl:!0,allowChat:!1,allowCrossQueueRequeue:!1,allowInbound:!0,allowLeadInserts:!1,allowLeadSearch:!1,allowLoginControl:!0,allowLoginUpdates:!0,allowManualCalls:!0,allowManualPass:!0,allowManualIntlCalls:!1,allowManualOutboundGates:!1,allowOffHook:!0,allowOutbound:!0,allowPreviewLeadFilters:!1,allowLeadUpdatesByCampaign:{},disableSupervisorMonitoring:!0,requireFetchedLeadsCalled:!1,showLeadHistory:!0},chatSettings:{availableChatQueues:[],availableChatRooms:[],chatQueues:[],alias:""},connectionSettings:{hashCode:null,reconnect:!1},inboundSettings:{availableQueues:[],availableSkillProfiles:[],queues:[],skillProfile:{}},outboundSettings:{availableCampaigns:[],availableOutdialGroups:[],insertCampaigns:[],outdialGroup:{}},surveySettings:{availableSurveys:[]}}}var b;return{getInstance:function(){return b||(b=a()),b}}}(),p={sendMessage:function(a,b){1===a.socket.readyState?a.socket.send(b):console.warn("AgentLibrary: WebSocket is not connected, cannot send message.")},processResponse:function(a,b){var c=b.ui_response["@type"],d=b.ui_response["@message_id"],e=""===d?"IS":d.slice(0,2);switch(console.log("AgentLibrary: received response: ("+e+") "+c.toUpperCase()),p.fireCallback(a,q.ON_MESSAGE,b),c.toUpperCase()){case r.LOGIN:"IS"===e?(o.getInstance().loginRequest.processResponse(b),p.fireCallback(a,q.LOGIN,b)):"IQ"===e&&(o.getInstance().configRequest.processResponse(b),p.fireCallback(a,q.CONFIG,b));break;case r.LOGOUT:p.fireCallback(a,q.LOGOUT,b);break;case r.AGENT_STATE:null===o.getInstance().agentStateRequest&&(o.getInstance().agentStateRequest=new i(b.ui_response.current_state["#text"],b.ui_response.agent_aux_state["#text"])),o.getInstance().agentStateRequest.processResponse(b),p.fireCallback(a,q.AGENT_STATE,b);break;case r.OFFHOOK_INIT:o.getInstance().offhookInitRequest.processResponse(b),p.fireCallback(a,q.OFFHOOK_INIT,b)}},processNotification:function(a,b){var c=b.ui_notification["@type"],d=b.ui_notification["@message_id"],e=""===d?"IS":d.slice(0,2);switch(console.log("AgentLibrary: received notification: ("+e+") "+c.toUpperCase()),c.toUpperCase()){case r.OFFHOOK_TERM:null===o.getInstance().offhookTermRequest&&(o.getInstance().offhookTermRequest=new n),o.getInstance().offhookTermRequest.processResponse(b),p.fireCallback(a,q.OFFHOOK_TERM,b)}},processResponseCollection:function(a,b,c){var d=[],e={},f=[];if(a[b]&&"undefined"!=typeof a[b][c]&&(f=a[b][c]),Array.isArray(f))for(var g=0;g<f.length;g++){var h="";for(var i in f[g])if(h=i.replace(/@/,""),h=h.replace(/_([a-z])/g,function(a){return a[1].toUpperCase()}),"object"==typeof f[g][i]){var j=Object.keys(f[g][i])[0],k=[];k=p.processResponseCollection(f[g],i,j),e[h]=k}else e[h]=f[g][i];d.push(e),e={}}else{var l="";for(var m in f)if(l=m.replace(/@/,""),l=l.replace(/_([a-z])/g,function(a){return a[1].toUpperCase()}),"object"==typeof f[m]){var n=Object.keys(f[m])[0],o=[];o=p.processResponseCollection(f,m,n),e[l]=f[m]}else e[l]=f[m];d.push(e)}return d},fireCallback:function(a,b,c){c=c||"","function"==typeof a.callbacks[b]&&a.callbacks[b].call(a,c)},setCallback:function(a,b,c){"undefined"!=typeof c&&(a.callbacks[b]=c)},getMessageId:function(){function a(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()},checkExistingIds:function(a,b,c){for(var d=[],e=[],f=0;f<a.length;f++)d.push(a[f][c]);for(var g=0;g<b.length;g++)-1===d.indexOf(b[g])&&e.push(b[g]);for(var h=b.length-1;h>=0;h--)e.indexOf(b[h])>-1&&b.splice(h,1);return b},validateDest:function(a){var b=!1,c=/^\d+$/.test(a);return c&&10===a.length?b=!0:"sip:"===a.slice(0,4).toLowerCase()&&-1!==a.indexOf("@")&&(b=!0),b}};const q={AGENT_STATE:"agentStateResponse",CLOSE_SOCKET:"closeResponse",CONFIG:"configureResponse",LOGIN:"loginResponse",OFFHOOK_INIT:"offhookInitResponse",OFFHOOK_TERM:"offhookTermResponse",OPEN_SOCKET:"openResponse"},r={LOGIN:"LOGIN",LOGOUT:"LOGOUT",AGENT_STATE:"AGENT-STATE",ON_MESSAGE:"ON-MESSAGE",OFFHOOK_INIT:"OFF-HOOK-INIT",OFFHOOK_TERM:"OFF-HOOK-TERM"};var s=function(a){return f(a),g(a),h(a),a.AgentLibrary};"function"==typeof define&&define.amd?(console.log("AgentLibrary: using AMD"),define(function(){return s({})})):"object"==typeof module&&module.exports?(console.log("AgentLibrary: Using Node"),module.exports=s(this)):(console.log("AgentLibrary: Not using AMD"),s(this))}(this);